<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>å ±ååå–® | ä½³é‡Œå¥‡ç¾é†«é™¢114å¹´åº¦é¤æ•˜</title> 
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;600;700&display=swap" rel="stylesheet">
<style>
body { font-family:'Noto Sans TC',sans-serif; background: linear-gradient(135deg,#E6E6FA,#FFFFFF); margin:0; padding:0; color:#000; overflow-x:hidden; position:relative; }
.bubble { position:absolute; border-radius:50%; opacity:0.5; pointer-events:none; z-index:0; }

.navbar { background-color: #4B0082 !important;background: rgba(10,10,10,0.85); backdrop-filter: blur(10px); border-bottom:1px solid rgba(255,255,255,0.1); }
.navbar-brand, .nav-link { color:#FFFFFF !important; font-weight:700; }
.nav-link:hover, .nav-link.active { color:#FFD700 !important; }

h2 { color:#4B0082; font-weight:600; text-shadow:1px 1px 3px rgba(0,0,0,0.2); }

.card { background: rgba(255,255,255,0.9); border-radius:15px; padding:25px; box-shadow:0 10px 25px rgba(0,0,0,0.3); margin-bottom:40px; position:relative; z-index:1; }

.filter-input { width: 100%; font-size: 0.85rem; padding: 3px; border: 1px solid #ccc; border-radius: 5px; text-align: center; }

#stats { font-size:1rem; font-weight:600; margin-bottom:15px; text-align:center; color:#4B0082; }

#filteredCount { font-size:0.95rem; font-weight:500; margin-bottom:10px; text-align:center; color:#4B0082; }

.table-responsive { max-height: 500px; overflow: auto; position: relative; }
.table-responsive table { width: max-content; min-width: 100%; table-layout: auto; }

#checkinTable thead th { position: sticky; top: 0; z-index: 2; background-color: #4B0082 !important; color: #fff !important; }

#checkinTable tbody tr:nth-child(even) { background-color: #F3E8FF; }
#checkinTable tbody tr:nth-child(odd) { background-color: #FFFFFF; }

/* åºè™Ÿæ¬„å‚ç›´ç½®ä¸­ä¸¦å›ºå®š */
#checkinTable th:first-child,
#checkinTable td:first-child {
    vertical-align: middle !important;
    text-align: center !important;
    white-space: nowrap;
    width: 60px;
    position: sticky;
    left: 0;
    background-color: #fff;
    z-index: 4;
}

/* å§“åæ¬„å‚ç›´ç½®ä¸­ä¸¦å›ºå®š */
#checkinTable th:nth-child(2),
#checkinTable td:nth-child(2) {
    vertical-align: middle !important;
    text-align: center;
    position: sticky;
    left: 60px; /* åºè™Ÿæ¬„å¯¬åº¦ */
    background-color: #fff;
    z-index: 3;
}

/* è¡¨é ­å§“åæ¬„æ›´é«˜å±¤ç´š */
#checkinTable thead th:nth-child(2) {
    z-index: 5;
}
#checkinTable thead th:first-child {
    z-index: 6;
}

footer { text-align:center; color:#555; background: rgba(255,255,255,0.1); padding:15px; font-size:0.95rem; margin-top:60px; }

/* æ‰‹æ©Ÿç‰ˆï¼šéš±è—å–®ä½ã€è·ç¨±ã€å‚™è¨»çš„æœå°‹æ¬„ä½ */
@media (max-width: 768px) {
  #checkinTable thead th:nth-child(3) .filter-input,
  #checkinTable thead th:nth-child(4) .filter-input,
  #checkinTable thead th:nth-child(5) .filter-input {
    display: none !important;
  }
}

@media (max-width: 768px) {
  .table-responsive { overflow-x: auto; }
  .filter-input { font-size: 0.75rem; }
}
</style>
</head>
<body>

<nav class="navbar navbar-expand-lg navbar-dark fixed-top">
  <div class="container">
    <a class="navbar-brand" href="index.html">
       <img src="chimei-logo-green.png" alt="å¥‡ç¾é†«é™¢" style="height:36px; margin-right:8px;">
      ä½³é‡Œå¥‡ç¾é†«é™¢114å¹´åº¦é¤æ•˜
    </a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse justify-content-end" id="navbarNav">
      <ul class="navbar-nav">
         <li class="nav-item"><a class="nav-link" href="index.html">å›é¦–é </a></li>
            <li class="nav-item"><a class="nav-link" href="agenda.html">æ´»å‹•æµç¨‹</a></li>
            <li class="nav-item"><a class="nav-link active" href="register.html">å ±ååå–®</a></li>
            <li class="nav-item"><a class="nav-link nav-link-arrow" href="checkin-çµ‚ç‰ˆ-F-è¤‡è£½-test.html">ç°½åˆ°å…¥å ´</a></li>
            <li class="nav-item"><a class="nav-link" href="honors.html">æ–°é€²é†«å¸«/å¹´åº¦å„ªè‰¯æ•™å¸«ç²¾é¸é›†</a></li>
            <li class="nav-item"><a class="nav-link" href="https://forms.gle/DBdC3ZScynWDzEps5" target="_blank">æ»¿æ„åº¦å›é¥‹</a></li>
      </ul>
    </div>
  </div>
</nav>

<main class="container" style="padding-top:100px;">
<div class="text-center mb-2">
  <h2>âœ… å·²å ±åèˆ‡æœƒäººå“¡</h2>
  <div class="d-flex justify-content-center align-items-center gap-2 mb-3">
    <input id="globalSearch" type="text" class="form-control w-50" placeholder="ğŸ” å…¨æ¬„æœå°‹ï¼ˆå§“åã€ç§‘åˆ¥ã€å–®ä½ã€å‚™è¨»ï¼‰">
    <button class="refresh-btn" onclick="filterTable()">ğŸ” æœå°‹</button>
  </div>
</div>

<div id="stats"></div>
<div id="filteredCount"></div>

<div class="card">
  <div class="table-responsive">
    <table class="table align-middle text-center" id="checkinTable">
      <thead class="table-dark">
        <tr>
          <th>åºè™Ÿ</th>
          <th>å§“å</th>
          <th>å–®ä½<br><input type="text" class="filter-input" placeholder="ç¯©é¸" onkeyup="columnFilter(2,this.value)"></th>
          <th>è·ç¨±<br><input type="text" class="filter-input" placeholder="ç¯©é¸" onkeyup="columnFilter(3,this.value)"></th>
          <th>å‚™è¨»<br><input type="text" class="filter-input" placeholder="ç¯©é¸" onkeyup="columnFilter(4,this.value)"></th>
        </tr>
      </thead>
      <tbody id="tableBody">
        <tr><td colspan="5" class="text-center text-muted">è³‡æ–™è¼‰å…¥ä¸­...</td></tr>
      </tbody>
    </table>
  </div>
</div>
</main>

<footer>
Â© 2025 ä½³é‡Œå¥‡ç¾é†«é™¢ï¼æ•™å­¸ç ”ç©¶çµ„ | Designed for 114å¹´åº¦é¤æ•˜
</footer>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<script>
const WEB_APP_URL = "https://script.google.com/macros/s/AKfycbyT8PHxSadUi-cL2B-kDpN9DkqqRopc7QLMaXDrgNziv-Jsj9jZ7EqtPTFQT_FhFadz/exec";
const tableBody = document.getElementById('tableBody');
const statsEl = document.getElementById('stats');
const filteredCountEl = document.getElementById('filteredCount');

function maskName(name){
  if(!name) return '';
  if(name.length < 2) return name;
  return name[0] + 'O' + name.slice(2);
}

async function fetchCheckinData(){
  try{
    tableBody.innerHTML=`<tr><td colspan="5" class="text-center text-muted">è³‡æ–™æ›´æ–°ä¸­...</td></tr>`;
    const res = await fetch(WEB_APP_URL);
    const data = await res.json();
    if(!data||data.length===0){
      tableBody.innerHTML=`<tr><td colspan="5" class="text-center text-muted">ç›®å‰å°šç„¡å ±åè³‡æ–™</td></tr>`;
      statsEl.textContent='';
      filteredCountEl.textContent='';
      return;
    }
    tableBody.innerHTML='';
    data.forEach((p,i)=>{
      if(!p.name) return;
      const row=document.createElement('tr');
      row.innerHTML=`<td>${i+1}</td>
      <td>${maskName(p.name)}</td>
      <td>${p.department||''}</td>
      <td>${p.unit||''}</td>
      <td>${p.remark||''}</td>`;
      tableBody.appendChild(row);
    });
    statsEl.textContent=`ç¸½å ±åäººæ•¸ï¼š${data.length}`;
    updateFilteredCountAndReindex();
  }catch(err){
    console.error(err);
    tableBody.innerHTML=`<tr><td colspan="5" class="text-danger">âš ï¸ è³‡æ–™è¼‰å…¥å¤±æ•—</td></tr>`;
    filteredCountEl.textContent='';
  }
}

function columnFilter(colIndex,value){
  const rows=tableBody.getElementsByTagName('tr');
  const filter=value.toLowerCase();
  for(let row of rows){
    const cell=row.cells[colIndex]?.textContent.toLowerCase()||'';
    row.style.display=cell.includes(filter)?'':'none';
  }
  updateFilteredCountAndReindex();
}

function filterTable(){
  const filter=document.getElementById('globalSearch').value.toLowerCase();
  const rows=tableBody.getElementsByTagName('tr');
  for(let row of rows){
    const text=row.textContent.toLowerCase();
    row.style.display=text.includes(filter)?'':'none';
  }
  updateFilteredCountAndReindex();
}

function updateFilteredCountAndReindex(){
  const rows=tableBody.getElementsByTagName('tr');
  let count=0, seq=1;
  for(let row of rows){
    if(row.style.display!=='none'){
      row.cells[0].textContent=seq++;
      count++;
    }
  }
  filteredCountEl.textContent=`ç›®å‰ç¬¦åˆæ¢ä»¶çš„äººæ•¸ï¼š${count}`;
}

fetchCheckinData();
</script>
</body>
</html>



